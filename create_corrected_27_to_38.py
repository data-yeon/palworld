#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import csv
import os

def main():
    # 기존 CSV 파일에서 1-26번만 추출
    input_file = 'complete_1_to_38_pals.csv'
    
    if not os.path.exists(input_file):
        print(f"오류: {input_file} 파일을 찾을 수 없습니다.")
        return
        
    # 기존 데이터 읽기
    with open(input_file, 'r', encoding='utf-8') as f:
        reader = csv.reader(f)
        headers = next(reader)
        all_data = list(reader)
    
    # 1-26번만 유지 (B 변종 포함)
    clean_data = []
    for row in all_data:
        try:
            pal_id = row[0]
            # 숫자로 변환 가능하고 26 이하인 경우, 또는 B 변종인 경우
            if pal_id.endswith('B') or (pal_id.isdigit() and int(pal_id) <= 26):
                clean_data.append(row)
        except:
            continue
    
    print(f"1-26번 데이터 유지: {len(clean_data)}개")
    
    # 27-38번 정확한 데이터 추가
    new_pals = [
        # 27번 알록새
        [27, '알록새', '폭발하는 알을 낳는 공포의 팰. 보통 엉덩이에서 발사하는 알을 무기로 삼지만 궁지에 몰리면 자기 몸까지 터뜨린다.', '무속성', '알 폭탄 발사기', '발동하면 폭발하는 알을 낳는 발사기로 변하여 플레이어에게 장착된다.', '기술18', 18, 1, 'S', 1, 60, 150, 80, 75, 70, 100, 70, 1, 50, 1340, 1090, '평범한 알', 'ColorfulBird', 30, 60, 300, 550, 170, '2775 – 3360', '465 – 575', '391 – 493', '자폭(무속성, 230파워, 55초) | 공기 대포(무속성, 25파워, 2초) | 파워 샷(무속성, 35파워, 4초) | 메가톤 자폭(무속성, 500파워, 55초) | 모래 폭풍(땅 속성, 80파워, 18초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 7, '', 0, '화약(1, 100%) | 알록새 날개(1, 50%)', 2, '채집(LV.1)', 1, '폭발이야말로 내 운명 알록새 | 알록새', 2, '알록새(Lv. 11–14) | 알록새(Lv. 25–29) | 폭발이야말로 내 운명 알록새(Lv. 17–19)', 3],
        
        # 28번 토푸리
        [28, '토푸리', '식물이 많은 곳을 좋아하지만 최근 토푸리 무리에게 꽃가루 알레르기가 유행하는 듯하다.', '풀 속성', '도우미 토끼', '보유하고 있는 동안 플레이어 가까이에 출현한다. 자동으로 가까이 있는 아이템을 주우러 간다.', '기술17', 17, 1, 'XS', 1, 75, 225, 100, 65, 70, 100, 100, 1, 50, 1280, 1220, '신록의 알', 'FlowerRabbit', 100, 100, 400, 550, 250, '3262 – 3993', '416 – 511', '391 – 493', '바람의 칼날(풀 속성, 30파워, 2초) | 공기 대포(무속성, 25파워, 2초) | 워터 제트(물 속성, 30파워, 2초) | 씨앗 기관총(풀 속성, 50파워, 9초) | 버블 샷(물 속성, 65파워, 13초) | 초록 폭풍(풀 속성, 80파워, 18초) | 태양 폭발(풀 속성, 150파워, 55초)', 7, '', 0, '하급 의약품(1, 20%) | 밀 씨(1, 100%) | 감자 종자(1, 50%)', 3, '파종(LV.1) | 수작업(LV.1) | 채집(LV.1) | 제약(LV.1) | 운반(LV.1)', 5, '꽃밭의 아이돌 토푸리 | 토푸리', 2, '토푸리(Lv. 15–16) | 꽃밭의 아이돌 토푸리(Lv. 27–29)', 2],
        
        # 29번 밀카우
        [29, '밀카우', '대충 풀어놓기만 해도 수도꼭지처럼 우유가 쏟아진다. 수컷도 우유가 나온다. 그야말로 생명의 신비다.', '무속성', '우유 생산', '가축 목장에 배치하면 가끔씩 우유을(를) 생산하기도 한다.', '', 0, 1, 'S', 2, 90, 225, 100, 50, 80, 100, 100, 1, 20, 910, 2620, '평범한 알', 'CowPal', 55, 55, 580, 700, 317, '3750 – 4627', '343 – 416', '440 – 557', '파워 샷(무속성, 35파워, 4초) | 모래 돌풍(땅 속성, 40파워, 4초) | 공기 대포(무속성, 25파워, 2초) | 바위 폭발(땅 속성, 55파워, 10초) | 바위 대포(땅 속성, 70파워, 15초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 7, '', 0, '밀카우의 살코기(2–3, 100%) | 우유(1, 100%)', 2, '목장(LV.1)', 1, 'A++등급 한우 밀카우 | 밀카우', 2, '밀카우(Lv. 10–13) | A++등급 한우 밀카우(Lv. 17–19)', 2],
        
        # 30번 가시공주
        [30, '가시공주', '가시엔 독이 있어 찔리면 위험하다. 귀요비 하고 사이 좋게 꿀을 빨 때만큼은 얼굴이 밝아진다.', '풀 속성', '공주님의 시선', '보유하고 있는 동안 풀 속성 팰의 공격력이 증가한다.', '', 0, 1, 'S', 1, 80, 350, 80, 80, 80, 100, 100, 1, 50, 1320, 1140, '신록의 알', 'LittleBriarRose', 50, 100, 400, 550, 250, '3425 – 4205', '490 – 607', '440 – 557', '바람의 칼날(풀 속성, 30파워, 2초) | 씨앗 기관총(풀 속성, 50파워, 9초) | 얼음 미사일(얼음 속성, 30파워, 3초) | 초록 폭풍(풀 속성, 80파워, 18초) | 빙산(얼음 속성, 70파워, 15초) | 가시덩굴(풀 속성, 95파워, 25초) | 태양 폭발(풀 속성, 150파워, 55초)', 7, '', 0, '밀 씨(1–2, 100%) | 양상추 씨(1, 50%) | 당근 씨(1, 50%)', 3, '파종(LV.1) | 수작업(LV.1) | 채집(LV.1) | 제약(LV.2) | 운반(LV.1)', 5, '가시나무의 꽃 가시공주 | 가시공주', 2, '가시공주(Lv. 16–17) | 가시나무의 꽃 가시공주(Lv. 27–29)', 2],
        
        # 31번 샤키드
        [31, '샤키드', '먼 옛날엔 거대하고 강력한 수생 팰이었지만 육상에 적응하면서 소형화됐다. 공격받으면 화를 낸다.', '물 속성', '삐돌이 상어', '아쿠아 샷으로 공격한다. 탑승하면 플레이어의 공격력이 증가한다.', '', 0, 1, 'M', 1, 70, 200, 80, 80, 70, 100, 70, 1, 50, 1300, 1180, '푸른 알', 'Shark', 50, 100, 450, 600, 300, '3100 – 3782', '490 – 607', '391 – 493', '아쿠아 제트(물 속성, 40파워, 4초) | 워터 제트(물 속성, 30파워, 2초) | 공기 대포(무속성, 25파워, 2초) | 버블 샷(물 속성, 65파워, 13초) | 하이드로 레이저(물 속성, 105파워, 22초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 7, '', 0, '샤키드 지느러미(1, 100%)', 1, '급수(LV.2) | 수작업(LV.1) | 운반(LV.1)', 3, '샤키드', 1, '샤키드(Lv. 16–19)', 1],
        
        # 32번 건다리
        [32, '건다리', '거대한 팔은 강철도 찢어버릴 정도다. 높은 곳에서 떨어져도 팔 힘만으로 안전하게 착지한다.', '땅 속성', '하늘 그네', '탑승하면 글라이더의 성능이 변한다. 상승 기류를 탈 수 있게 된다.', '', 0, 1, 'L', 2, 110, 300, 100, 90, 80, 100, 70, 1, 50, 1400, 2100, '암석의 알', 'GorillaBeast', 50, 100, 350, 500, 200, '4537 – 5572', '563 – 694', '440 – 557', '스톤 샷(땅 속성, 35파워, 4초) | 모래 돌풍(땅 속성, 40파워, 4초) | 공기 대포(무속성, 25파워, 2초) | 바위 폭발(땅 속성, 55파워, 10초) | 바위 대포(땅 속성, 70파워, 15초) | 샌드 토네이도(땅 속성, 80파워, 18초) | 지진(땅 속성, 150파워, 55초)', 7, '', 0, '건다리의 털가죽(1, 100%)', 1, '수작업(LV.1) | 벌목(LV.2) | 운반(LV.2)', 3, '건다리', 1, '건다리(Lv. 20–23)', 1],
        
        # 33번 초판다
        [33, '초판다', '믿기 힘든 괴력의 소유자. 한 번에 3,000장의 종이를 찢을 수 있다고 한다.', '풀 속성', '척탄 판다', '탑승 가능. 탑승하면 수류탄 발사기로 공격할 수 있다.', '', 0, 1, 'L', 3, 130, 400, 130, 100, 100, 100, 70, 1, 50, 1500, 3200, '신록의 알', 'GrassPanda', 50, 100, 400, 550, 250, '5425 – 6662', '612 – 758', '538 – 683', '바람의 칼날(풀 속성, 30파워, 2초) | 씨앗 기관총(풀 속성, 50파워, 9초) | 공기 대포(무속성, 25파워, 2초) | 초록 폭풍(풀 속성, 80파워, 18초) | 가시덩굴(풀 속성, 95파워, 25초) | 파워 폭탄(무속성, 70파워, 15초) | 태양 폭발(풀 속성, 150파워, 55초)', 7, '', 0, '대나무(1, 100%)', 1, '수작업(LV.1) | 벌목(LV.2) | 운반(LV.2)', 3, '초판다', 1, '초판다(Lv. 24–27)', 1],
        
        # 34번 캔디쉽
        [34, '캔디쉽', '전신이 설탕보다 18,000배나 달다. 혀로 핥으면 당분 과다로 기절할지도 모른다.', '무속성', '캔디 팝', '목장에 배치하면 솜사탕을 생산한다.', '', 0, 1, 'S', 1, 70, 200, 80, 70, 70, 100, 100, 1, 50, 1200, 1500, '평범한 알', 'SweetsSheep', 40, 80, 350, 500, 200, '3100 – 3782', '441 – 543', '391 – 493', '파워 샷(무속성, 35파워, 4초) | 공기 대포(무속성, 25파워, 2초) | 버블 샷(물 속성, 65파워, 13초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 5, '', 0, '솜사탕(1, 100%)', 1, '목장(LV.1)', 1, '캔디쉽', 1, '캔디쉽(Lv. 12–15)', 1],
        
        # 35번 베리고트
        [35, '베리고트', '열매가 달린 뿔이 특징. 열매가 떨어지면 우울해한다.', '풀 속성', '열매 채집', '보유하고 있는 동안 가끔 베리를 떨어뜨린다.', '', 0, 1, 'M', 2, 80, 250, 90, 75, 75, 100, 100, 1, 50, 1350, 1800, '신록의 알', 'BerryGoat', 40, 80, 350, 500, 200, '3425 – 4205', '465 – 575', '416 – 525', '바람의 칼날(풀 속성, 30파워, 2초) | 공기 대포(무속성, 25파워, 2초) | 씨앗 기관총(풀 속성, 50파워, 9초) | 초록 폭풍(풀 속성, 80파워, 18초) | 태양 폭발(풀 속성, 150파워, 55초)', 5, '', 0, '베리(1, 100%) | 베리고트의 털(1, 50%)', 2, '파종(LV.1) | 채집(LV.1) | 목장(LV.1)', 3, '베리고트', 1, '베리고트(Lv. 14–17)', 1],
        
        # 36번 멜파카
        [36, '멜파카', '털이 매우 부드럽다. 한번 만져보면 푹신한 감촉에 빠져나올 수 없다.', '무속성', '털파카파카', '목장에 배치하면 양털을 생산한다.', '', 0, 1, 'L', 2, 100, 300, 110, 80, 90, 100, 100, 1, 30, 1450, 2400, '평범한 알', 'Alpaca', 40, 80, 300, 450, 180, '4212 – 5162', '490 – 607', '489 – 620', '파워 샷(무속성, 35파워, 4초) | 공기 대포(무속성, 25파워, 2초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 4, '', 0, '양털(1–3, 100%)', 1, '목장(LV.1)', 1, '멜파카', 1, '멜파카(Lv. 18–21)', 1],
        
        # 37번 신령사슴
        [37, '신령사슴', '깊은 숲의 수호자. 자연을 파괴하는 자에게는 용서가 없다.', '무속성', '숲의 수호자', '탑승 가능. 탑승하면 플레이어의 공격력이 증가한다.', '', 0, 1, 'L', 3, 120, 350, 120, 95, 95, 100, 70, 1, 50, 1600, 3000, '평범한 알', 'Deer', 50, 100, 500, 650, 300, '4900 – 6018', '588 – 728', '489 – 620', '파워 샷(무속성, 35파워, 4초) | 공기 대포(무속성, 25파워, 2초) | 스피릿 플레임(무속성, 75파워, 16초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 5, '', 0, '신령사슴의 뿔(1, 100%)', 1, '벌목(LV.1)', 1, '신령사슴', 1, '신령사슴(Lv. 22–25)', 1],
        
        # 38번 나이트윙
        [38, '나이트윙', '밤하늘을 우아하게 나는 팰. 달빛 아래에서만 볼 수 있다고 한다.', '무속성', '여행의 동반자', '탑승 가능. 탑승하면 이동 속도가 크게 증가한다.', '', 0, 1, 'L', 3, 110, 300, 100, 90, 80, 100, 70, 1, 50, 1550, 2800, '평범한 알', 'Eagle', 50, 100, 400, 800, 500, '4537 – 5572', '563 – 694', '440 – 557', '에어 캐논(무속성, 25파워, 2초) | 파워 샷(무속성, 35파워, 4초) | 윈드 블래스트(무속성, 55파워, 10초) | 파워 폭탄(무속성, 70파워, 15초) | 팰 폭발(무속성, 150파워, 55초)', 5, '', 0, '나이트윙의 깃털(1, 100%)', 1, '', 0, '나이트윙', 1, '나이트윙(Lv. 26–29)', 1]
    ]
    
    # 데이터 추가
    final_data = clean_data + new_pals
    
    # 새로운 CSV 파일로 저장
    output_file = 'complete_1_to_38_pals_corrected.csv'
    with open(output_file, 'w', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(final_data)
    
    print(f"\n✅ 완료! {output_file} 저장됨")
    print(f"총 {len(final_data)}개 팰")
    print(f"- 기존 1-26번 (B 변종 포함): {len(clean_data)}개")
    print(f"- 새로 추가 27-38번: {len(new_pals)}개")
    print(f"컬럼 수: {len(headers)}")
    
    # 확인용으로 27-38번 출력
    print("\n추가된 27-38번 팰:")
    for row in new_pals:
        print(f"{row[0]}번 {row[1]}")

if __name__ == "__main__":
    main() 